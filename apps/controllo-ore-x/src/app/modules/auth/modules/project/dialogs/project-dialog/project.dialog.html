<lib-dialog-template
  [cTitle]="title"
  [isFooterEnabled]="true"
  (closeDialog)="cancel()"
  [isLoading]="isLoading"
  [isError]="hasErrors"
>
  <div body>
    <form class="-form p-0" [formGroup]="formHelper.form">
      <div class="row mb-2 -form__fields">
        <mat-form-field class="col" appearance="outline">
          <mat-label>Nome progetto</mat-label>
          <input matInput placeholder="Nome" formControlName="name" />
          <mat-error *ngFor="let error of [RT_FORM_ERRORS['REQUIRED']]">
            <div *ngIf="formHelper.form.controls['name'].hasError(error.name)">
              {{ error.message }}
            </div>
          </mat-error>
        </mat-form-field>

        <mat-form-field class="col" appearance="outline">
          <mat-label>Cliente</mat-label>
          <mat-select
            matInput
            placeholder="Cliente"
            formControlName="customer"
            [(value)]="currentCustomer"
          >
            <mat-option *ngFor="let customer of customers" [value]="customer">
              {{ customer.name }}
            </mat-option>
          </mat-select>
          <mat-error *ngFor="let error of [RT_FORM_ERRORS['REQUIRED']]">
            <div
              *ngIf="formHelper.form.controls['customer'].hasError(error.name)"
            >
              {{ error.message }}
            </div>
          </mat-error>
        </mat-form-field>

        <button
          mat-flat-button
          *ngIf="isCreating"
          class="button -form__fields__button"
          (click)="openCreateCustomer()"
        >
          Crea nuovo cliente
        </button>

        <mat-form-field appearance="outline">
          <mat-label>Colore</mat-label>
          <mat-select
            matInput
            placeholder="Colore"
            formControlName="color"
            [(value)]="currentColor"
          >
            <mat-select-trigger>
              <div
                class="-color-square"
                [style.backgroundColor]="currentColor"
              ></div>
            </mat-select-trigger>
            <mat-option *ngFor="let color of colors" [value]="color">
              <div class="-color-square" [style.backgroundColor]="color"></div>
            </mat-option>
          </mat-select>
          <mat-error *ngFor="let error of [RT_FORM_ERRORS['REQUIRED']]">
            <div *ngIf="formHelper.form.controls['color'].hasError(error.name)">
              {{ error.message }}
            </div>
          </mat-error>
        </mat-form-field>

        <mat-form-field class="col" appearance="outline">
          <mat-label>Budget ore</mat-label>
          <input
            type="number"
            matInput
            placeholder="Budget ore"
            formControlName="hoursBudget"
            min="0"
          />
          <mat-error *ngFor="let error of [RT_FORM_ERRORS['REQUIRED']]">
            <div
              *ngIf="formHelper.form.controls['hoursBudget'].hasError(error.name)"
            >
              {{ error.message }}
            </div>
          </mat-error>
        </mat-form-field>

        <mat-form-field class="col" appearance="outline">
          <mat-label>Data di scadenza</mat-label>
          <input
            matInput
            [matDatepicker]="picker"
            placeholder="Data di scadenza"
            formControlName="deadline"
          />
          <mat-error *ngFor="let error of [RT_FORM_ERRORS['REQUIRED']]">
            <div
              *ngIf="formHelper.form.controls['deadline'].hasError(error.name)"
            >
              {{ error.message }}
            </div>
          </mat-error>
          <mat-datepicker-toggle matIconSuffix [for]="picker">
            <mat-icon matDatepickerToggleIcon>keyboard_arrow_down</mat-icon>
          </mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
      </div>
    </form>
  </div>
  <div footer class="-footer">
    <button
      *ngIf="!isCreating"
      (click)="deleteEntity()"
      class="rt-btn -footer__button -footer__button--delete"
      mat-button
      type="button"
    >
      Elimina
    </button>
    <lib-rt-dialog-default-actions
      (confirm)="onSubmit()"
      (cancel)="cancel()"
    ></lib-rt-dialog-default-actions>
  </div>
</lib-dialog-template>
